(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,18566,(e,t,s)=>{t.exports=e.r(76562)},11870,e=>{"use strict";e.s(["default",()=>i]);var t=e.i(43476),s=e.i(57951),r=e.i(18566),a=e.i(71645);function i(e){let{children:i,requireAuth:l=!0,requireOnboarding:o=!0,allowedRoles:n=[]}=e,{user:d,isAuthenticated:c,isLoading:u}=(0,s.useAuth)(),m=(0,r.useRouter)();return((0,a.useEffect)(()=>{if(!u){if(l&&!c)return void m.push("/auth");if(l&&o&&d&&!d.isOnboarded)return void m.push("/onboarding");if(l&&n.length>0&&d&&!n.includes(d.role))return void m.push("/")}},[d,c,u,l,o,n,m]),u)?(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-black",children:"Loading..."})]})}):l&&!c||l&&o&&d&&!d.isOnboarded||l&&n.length>0&&d&&!n.includes(d.role)?null:(0,t.jsx)(t.Fragment,{children:i})}},5049,e=>{"use strict";e.s(["default",()=>l]);var t=e.i(43476),s=e.i(71645),r=e.i(22016),a=e.i(11870),i=e.i(57951);function l(){let{user:e}=(0,i.useAuth)(),[l,o]=(0,s.useState)([{id:"1",title:"Community Garden Initiative",description:"Create a community garden in the downtown area to promote sustainable living and food security.",category:"Environment",votesFor:35,votesAgainst:10,totalVotes:45,status:"ACTIVE",author:"Sarah Johnson",createdAt:"2025-01-03"},{id:"2",title:"Digital Literacy Program",description:"Provide free computer and internet training for seniors and underserved communities.",category:"Education",votesFor:25,votesAgainst:7,totalVotes:32,status:"ACTIVE",author:"Mike Chen",createdAt:"2025-01-02"},{id:"3",title:"Mental Health Support Network",description:"Establish peer support groups and counseling services for mental health awareness.",category:"Health",votesFor:50,votesAgainst:17,totalVotes:67,status:"PASSED",author:"Dr. Emily Rodriguez",createdAt:"2025-01-01"}]),[n,d]=(0,s.useState)({title:"",description:"",category:"Environment"}),[c,u]=(0,s.useState)(!1),[m,x]=(0,s.useState)({}),[h,b]=(0,s.useState)({1:["Great initiative! This will help our community.","I support this proposal."],2:["Excellent idea for digital literacy.","This is much needed in our area."],3:["Mental health support is crucial.","This initiative will save lives."]}),[p,g]=(0,s.useState)({}),v=async(t,s)=>{if(!e)return void alert("Please log in to vote");x(e=>({...e,[t]:!0}));try{let r={userId:e.id,proposalId:t,voteType:s},a=await fetch("http://localhost:3001/voting/vote",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}),i=await a.json();i.success?o(e=>e.map(e=>{if(e.id===t){let t="FOR"===s?e.votesFor+1:e.votesFor,r="AGAINST"===s?e.votesAgainst+1:e.votesAgainst;return{...e,votesFor:t,votesAgainst:r,totalVotes:t+r,userVote:s}}return e})):alert(i.message||"Failed to vote")}catch(e){console.error("Voting error:",e),alert("Failed to vote. Please try again.")}finally{x(e=>({...e,[t]:!1}))}};return(0,t.jsx)(a.default,{children:(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50",children:(0,t.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,t.jsxs)("div",{className:"text-center mb-12",children:[(0,t.jsx)("h1",{className:"text-4xl font-bold text-black mb-4",children:"Community Spaces"}),(0,t.jsx)("p",{className:"text-xl text-black max-w-2xl mx-auto",children:"Join the conversation and propose new initiatives. Vote on community proposals and help shape the future."})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-12",children:[(0,t.jsxs)("div",{className:"bg-white/70 backdrop-blur-sm rounded-2xl p-6 border border-white/20 shadow-lg",children:[(0,t.jsx)("h3",{className:"text-2xl font-bold text-black",children:"Active Proposals"}),(0,t.jsx)("p",{className:"text-3xl font-bold text-blue-600",children:l.filter(e=>"ACTIVE"===e.status).length})]}),(0,t.jsxs)("div",{className:"bg-white/70 backdrop-blur-sm rounded-2xl p-6 border border-white/20 shadow-lg",children:[(0,t.jsx)("h3",{className:"text-2xl font-bold text-black",children:"Total Votes"}),(0,t.jsx)("p",{className:"text-3xl font-bold text-green-600",children:l.reduce((e,t)=>e+t.totalVotes,0)})]}),(0,t.jsxs)("div",{className:"bg-white/70 backdrop-blur-sm rounded-2xl p-6 border border-white/20 shadow-lg",children:[(0,t.jsx)("h3",{className:"text-2xl font-bold text-black",children:"Passed Initiatives"}),(0,t.jsx)("p",{className:"text-3xl font-bold text-purple-600",children:l.filter(e=>"PASSED"===e.status).length})]})]}),(0,t.jsx)("div",{className:"text-center mb-8",children:(0,t.jsx)("button",{onClick:()=>u(!c),className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white px-8 py-3 rounded-lg font-medium hover:from-blue-700 hover:to-purple-700 transition-all duration-200 shadow-lg",children:c?"Cancel":"Propose New Initiative"})}),c&&(0,t.jsxs)("div",{className:"bg-white/70 backdrop-blur-sm rounded-2xl p-8 border border-white/20 shadow-lg mb-8",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-black mb-6",children:"Propose New Initiative"}),(0,t.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),n.title&&n.description){let e={id:Date.now().toString(),title:n.title,description:n.description,category:n.category,votesFor:0,votesAgainst:0,totalVotes:0,status:"ACTIVE",author:"You",createdAt:new Date().toISOString().split("T")[0]};o(t=>[e,...t]),d({title:"",description:"",category:"Environment"}),u(!1)}},className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-black mb-2",children:"Title"}),(0,t.jsx)("input",{type:"text",value:n.title,onChange:e=>d(t=>({...t,title:e.target.value})),className:"w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-black",placeholder:"Enter initiative title",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-black mb-2",children:"Description"}),(0,t.jsx)("textarea",{value:n.description,onChange:e=>d(t=>({...t,description:e.target.value})),className:"w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent h-32 text-black",placeholder:"Describe your initiative in detail",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-black mb-2",children:"Category"}),(0,t.jsxs)("select",{value:n.category,onChange:e=>d(t=>({...t,category:e.target.value})),className:"w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-black",children:[(0,t.jsx)("option",{value:"Environment",children:"Environment"}),(0,t.jsx)("option",{value:"Education",children:"Education"}),(0,t.jsx)("option",{value:"Health",children:"Health"}),(0,t.jsx)("option",{value:"Community",children:"Community"})]})]}),(0,t.jsxs)("div",{className:"flex gap-4",children:[(0,t.jsx)("button",{type:"submit",className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white px-6 py-3 rounded-lg font-medium hover:from-blue-700 hover:to-purple-700 transition-all duration-200",children:"Submit Proposal"}),(0,t.jsx)("button",{type:"button",onClick:()=>u(!1),className:"bg-gray-200 text-black px-6 py-3 rounded-lg font-medium hover:bg-gray-300 transition-all duration-200",children:"Cancel"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-black mb-6",children:"Community Proposals"}),l.map(e=>{var s,r;return(0,t.jsxs)("div",{className:"bg-white/70 backdrop-blur-sm rounded-2xl p-6 border border-white/20 shadow-lg hover:shadow-xl transition-all duration-300",children:[(0,t.jsx)("div",{className:"flex items-start justify-between mb-4",children:(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-black",children:e.title}),(0,t.jsx)("span",{className:"px-3 py-1 rounded-full text-sm font-medium ".concat((e=>{switch(e){case"Environment":return"bg-green-100 text-green-800";case"Education":return"bg-blue-100 text-blue-800";case"Health":return"bg-red-100 text-red-800";case"Community":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}})(e.category)),children:e.category}),(0,t.jsx)("span",{className:"px-3 py-1 rounded-full text-sm font-medium ".concat((e=>{switch(e){case"active":return"bg-yellow-100 text-yellow-800";case"passed":return"bg-green-100 text-green-800";case"rejected":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}})(e.status)),children:e.status})]}),(0,t.jsx)("p",{className:"text-black mb-4",children:e.description}),(0,t.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[(0,t.jsxs)("span",{children:["By ",e.author]}),(0,t.jsx)("span",{children:"•"}),(0,t.jsx)("span",{children:e.createdAt}),(0,t.jsx)("span",{children:"•"}),(0,t.jsxs)("span",{children:[e.totalVotes," votes (",e.votesFor," for, ",e.votesAgainst," against)"]})]})]})}),"ACTIVE"===e.status&&(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)("button",{onClick:()=>v(e.id,"FOR"),disabled:m[e.id]||"ACTIVE"!==e.status,className:"px-6 py-2 rounded-lg font-medium transition-all duration-200 ".concat("FOR"===e.userVote?"bg-green-600 text-white":"bg-gradient-to-r from-green-600 to-blue-600 text-white hover:from-green-700 hover:to-blue-700"," ").concat(m[e.id]||"ACTIVE"!==e.status?"opacity-50 cursor-not-allowed":""),children:m[e.id]?"Voting...":"Vote Yes"}),(0,t.jsx)("button",{onClick:()=>v(e.id,"AGAINST"),disabled:m[e.id]||"ACTIVE"!==e.status,className:"px-6 py-2 rounded-lg font-medium transition-all duration-200 ".concat("AGAINST"===e.userVote?"bg-red-600 text-white":"bg-gray-200 text-black hover:bg-gray-300"," ").concat(m[e.id]||"ACTIVE"!==e.status?"opacity-50 cursor-not-allowed":""),children:m[e.id]?"Voting...":"Vote No"})]}),(0,t.jsxs)("div",{className:"mt-6 border-t border-gray-200 pt-4",children:[(0,t.jsxs)("h4",{className:"text-lg font-semibold text-black mb-3",children:["Comments (",(null==(s=h[e.id])?void 0:s.length)||0,")"]}),(0,t.jsx)("div",{className:"space-y-3 mb-4",children:(h[e.id]||[]).map((e,s)=>(0,t.jsx)("div",{className:"bg-gray-50 rounded-lg p-3",children:(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white text-sm font-medium",children:"U"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("p",{className:"text-black text-sm",children:e}),(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Community Member"})]})]})},s))}),(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)("input",{type:"text",value:p[e.id]||"",onChange:t=>g(s=>({...s,[e.id]:t.target.value})),placeholder:"Add a comment...",className:"flex-1 px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-black"}),(0,t.jsx)("button",{onClick:()=>(e=>{let t=p[e];t&&t.trim()&&(b(s=>({...s,[e]:[...s[e]||[],t.trim()]})),g(t=>({...t,[e]:""})))})(e.id),disabled:!(null==(r=p[e.id])?void 0:r.trim()),className:"px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:"Comment"})]})]})]},e.id)})]}),(0,t.jsx)("div",{className:"text-center mt-12",children:(0,t.jsx)(r.default,{href:"/",className:"inline-flex items-center px-6 py-3 bg-white/70 backdrop-blur-sm text-black rounded-lg font-medium hover:bg-white/90 transition-all duration-200 border border-white/20 shadow-lg",children:"← Back to Home"})})]})})})}}]);